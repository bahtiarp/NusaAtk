<?php
  

/***********************************************************************
	ATK Module: welcome
	Date: 10/14/24

	
	This code was automatically generated by ATK Code Generator v2.2
	
	@Author Jorge Garifuna (GariDigital.com) <info@GariDigital.com>
	
	Your are free to modify this code to fit your needs. 
	All I ask for is for your to keep this notice on top of the code
************************************************************************/		
			
  class mod_welcome extends atkModule
  {           
    var $module = "welcome";
    
    function getMenuItems()
    {          
      $main_label = "Welcome";
      // the last parameter hides the main module menu for this node from users without access
	 $this->menuitem($main_label,"","main",array(
										$this->module.".dashboard","admin",$this->module.".dashboard","add",$this->module.".dashboard","edit",$this->module.".dashboard","delete",

										)); 
       
       // the last parameter hides the node menu from users without access
	$this->menuitem("Dashboard", dispatch_url($this->module.".dashboard", "admin"), $main_label,array($this->module.".dashboard","admin",$this->module.".dashboard","add",$this->module.".dashboard","edit",$this->module.".dashboard","delete"));
 

      /** 
       * The following line adds the new profiles menuitem.
       * New here is the 4th parameter to the menuitem() call. This parameter
       * makes the menuitem disappear, if the current user does not have the 
       * 'admin' privilege on the profile node.
       * If you don't pass this parameter, the menuitem is always visible, and
       * the user will get an 'access denied' message when clicking the item
       * anyway. (you can try this by accessing the 'lesson1' menuitems when
       * logged in as one of the employees.)
       */
      //$this->menuitem("profiles", dispatch_url("company.profile", "admin"), "company", array("company.profile", "admin"));
           
      //$this->menuitem("-", "", "company");
      
      //$this->menuitem("modulesource", moduleSourceUrl("company"), "company");
    }
    
    /**
     * This lesson contains security profiles. This means that no longer all
     * users may execute all actions. The administrator user still can, but
     * other users need privileges.
     * With this method, the system is instructed of the privileges that
     * exist. Usually, this corresponds to the actions that can be done
     * on a node.
     */
    function getNodes()
    {    
      /**
       * In this case, we tell the system that the nodes
       * have 'admin', 'add', 'edit' and 'delete' privileges.
       */
	registerNode($this->module.".dashboard", array("admin", "add", "edit", "delete"));

      //registerNode("company.profile", array("admin", "add", "edit", "delete", "grantall"));

    }


     /* start top search implementation */
     function search($expression){
          $res = array();
            
			$dashboard_node = atkGetNode($this->module.".dashboard");
			$res["dashboards"] = $this->recLinks($dashboard_node->searchDb($expression), $this->module.".dashboard");


           return $res;
       }// end function
     
       function recLinks($recordset, $nodetype)
         {
     
           $res = array();
     
           $node = atkGetNode($nodetype);
           if ($node->allowed("view"))
           {
             for($i=0, $_i=count($recordset); $i<$_i; $i++)
             {
               $item["title"] = $node->descriptor($recordset[$i]);
               $item["url"] = dispatch_url($nodetype, "view", array("atkselector"=>$node->primaryKey($recordset[$i])));
               $res[] = $item;
             }
           }
     
           return $res;
       } // end function
          /* end top search implementation */



               
    
  }// end class

?>